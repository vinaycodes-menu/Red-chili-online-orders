<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>RED CHILI RESTAURANT MENU</title>

    <!-- CSS -->
    <link rel="stylesheet" href="/css/style.css"/>
</head>

<body>

<header class="top-bar">
    <div class="restaurant-info">
        <h1>Red Chili Indian Restaurant</h1>
        <div class="restaurant-meta">
            <span>4.5 ‚òÖ</span>
        </div>
    </div>

    <div class="search-box">
        <input type="text" placeholder="Search for Food you need"/>
    </div>
</header>

<div class="main-layout">

    <!-- SIDEBAR -->
    <aside class="sidebar">
        <h2 class="sidebar-title">Full Menu</h2>
        <p class="sidebar-time">10:00 am - 8:00 pm</p>

        <nav class="menu-list">
            <a href="#biryani-section" class="menu-item active">Biryani</a>
            <a href="#curry-items" class="menu-item">Curries</a>
            <a href="#combo-section" class="menu-item">Combos</a>
        </nav>
    </aside>

    <!-- CONTENT -->
    <main class="content">

        <!-- BIRYANI -->
        <section id="biryani-section">
            <div class="card-row">

                <article class="dish-card">
                    <div class="dish-text">
                        <h3 class="dish-title">Chicken Dum Biryani</h3>
                        <p class="dish-desc">Whole chicken dum cooked in aromatic basmati rice.</p>
                        <p class="dish-meta"><span class="price">$7.99</span></p>
                    </div>
                    <div class="dish-image-wrapper">
                        <img src="/photos/cb.jpg" alt="Chicken Dum Biryani">
                    </div>
                    <div class="qty-control">
                        <button class="minus-btn">‚àí</button>
                        <span class="qty">0</span>
                        <button class="plus-btn">+</button>
                    </div>
                </article>

                <article class="dish-card">
                    <div class="dish-text">
                        <h3 class="dish-title">Mutton Dum Biryani</h3>
                        <p class="dish-desc">Slow cooked mutton layered with basmati rice.</p>
                        <p class="dish-meta"><span class="price">$12.99</span></p>
                    </div>
                    <div class="dish-image-wrapper">
                        <img src="/photos/mb.jpg" alt="Mutton Dum Biryani">
                    </div>
                    <div class="qty-control">
                        <button class="minus-btn">‚àí</button>
                        <span class="qty">0</span>
                        <button class="plus-btn">+</button>
                    </div>
                </article>

            </div>
        </section>

        <!-- CURRIES -->
        <section id="curry-items">
            <div class="card-row">

                <article class="dish-card">
                    <div class="dish-text">
                        <h3 class="dish-title">Butter Chicken</h3>
                        <p class="dish-desc">Creamy tomato gravy with tender chicken.</p>
                        <p class="dish-meta"><span class="price">$9.99</span></p>
                    </div>
                    <div class="dish-image-wrapper">
                        <img src="/photos/butterchicken.jpg" alt="Butter Chicken">
                    </div>
                    <div class="qty-control">
                        <button class="minus-btn">‚àí</button>
                        <span class="qty">0</span>
                        <button class="plus-btn">+</button>
                    </div>
                </article>

                <article class="dish-card">
                    <div class="dish-text">
                        <h3 class="dish-title">Chicken Curry</h3>
                        <p class="dish-desc">Traditional Kerala style chicken curry.</p>
                        <p class="dish-meta"><span class="price">$7.99</span></p>
                    </div>
                    <div class="dish-image-wrapper">
                        <img src="/photos/chickencurry.jpg" alt="Chicken Curry">
                    </div>
                    <div class="qty-control">
                        <button class="minus-btn">‚àí</button>
                        <span class="qty">0</span>
                        <button class="plus-btn">+</button>
                    </div>
                </article>

            </div>
        </section>

        <!-- COMBOS -->
        <section id="combo-section">
            <div class="card-row">

                <article class="dish-card">
                    <div class="dish-text">
                        <h3 class="dish-title">Chicken Tikka Combo</h3>
                        <p class="dish-desc">Chicken tikka with rice and naan.</p>
                        <p class="dish-meta"><span class="price">$11.99</span></p>
                    </div>
                    <div class="dish-image-wrapper">
                        <img src="/photos/ctmMeal.jpg" alt="Chicken Tikka Combo">
                    </div>
                    <div class="qty-control">
                        <button class="minus-btn">‚àí</button>
                        <span class="qty">0</span>
                        <button class="plus-btn">+</button>
                    </div>
                </article>

            </div>
        </section>

    </main>
</div>

<!-- CART BAR -->
<div class="order-bar">
    <div class="order-info">
        Items: <span class="cart-count">0</span> | Total: $<span class="cart-total">0.00</span>
    </div>
    <button class="order-link place-order-btn">üçΩÔ∏è Place Order</button>
</div>

<!-- JAVASCRIPT -->
<script>
    document.addEventListener("DOMContentLoaded", () => {

      const cart = {};

      const cartCountEl = document.querySelector(".cart-count");
      const cartTotalEl = document.querySelector(".cart-total");
      const placeOrderBtn = document.querySelector(".place-order-btn");

      function updateCartUI() {
        let totalItems = 0;
        let totalAmount = 0;

        Object.values(cart).forEach(item => {
          totalItems += item.qty;
          totalAmount += item.qty * item.price;
        });

        cartCountEl.textContent = totalItems;
        cartTotalEl.textContent = totalAmount.toFixed(2);
      }

      document.querySelectorAll(".plus-btn").forEach(btn => {
        btn.addEventListener("click", () => {
          const card = btn.closest(".dish-card");
          const name = card.querySelector(".dish-title").textContent.trim();
          const price = parseFloat(card.querySelector(".price").textContent.replace("$", ""));
          const qtyEl = card.querySelector(".qty");

          if (!cart[name]) {
            cart[name] = { price, qty: 0 };
          }

          cart[name].qty++;
          qtyEl.textContent = cart[name].qty;
          updateCartUI();
        });
      });

      document.querySelectorAll(".minus-btn").forEach(btn => {
        btn.addEventListener("click", () => {
          const card = btn.closest(".dish-card");
          const name = card.querySelector(".dish-title").textContent.trim();
          const qtyEl = card.querySelector(".qty");

          if (!cart[name]) return;

          cart[name].qty--;

          if (cart[name].qty <= 0) {
            delete cart[name];
            qtyEl.textContent = 0;
          } else {
            qtyEl.textContent = cart[name].qty;
          }

          updateCartUI();
        });
      });

      placeOrderBtn.addEventListener("click", () => {
        if (Object.keys(cart).length === 0) {
          alert("Please add at least one item.");
          return;
        }

        const items = Object.entries(cart)
          .map(([name, d]) => `${name} x${d.qty}`)
          .join(", ");

        fetch("/api/orders", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ items })
        })
        .then(res => {
          if (!res.ok) throw new Error();
          alert("‚úÖ Order placed successfully!");
          Object.keys(cart).forEach(k => delete cart[k]);
          document.querySelectorAll(".qty").forEach(q => q.textContent = 0);
          updateCartUI();
        })
        .catch(() => alert("‚ùå Failed to place order"));
      });

    });
</script>


</body>
</html>
